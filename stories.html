<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
<title>Stories – Olympic Shop</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ============================================================
   STORIES COMPONENT — Zalando-style
   Tall rectangular cards on all devices
   ============================================================ */

.stories-root, .stories-root *, .stories-root *::before, .stories-root *::after,
.story-viewer-overlay, .story-viewer-overlay *, .story-viewer-overlay *::before, .story-viewer-overlay *::after {
  margin: 0; padding: 0; box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
  -webkit-font-smoothing: antialiased;
}

.stories-root {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  width: 100%;
  overflow: hidden;
  background: #fff;
}

/* --- Section header --- */
.stories-header {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  padding: 20px 16px 12px;
}
@media (min-width: 768px) {
  .stories-header { padding: 32px 40px 20px; }
}
@media (min-width: 1200px) {
  .stories-header { padding: 36px 48px 22px; }
}
.stories-header h2 {
  font-size: 15px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: #111;
}
@media (min-width: 768px) {
  .stories-header h2 { font-size: 17px; }
}

/* Mobile circles removed — cards used on all viewports */

/* ============================================================
   CARD RAIL — Tall rectangular cards on all viewports
   ============================================================ */
.stories-rail--desktop {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  scroll-snap-type: x proximity;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
  padding: 0 16px 20px;
  scroll-behavior: smooth;
}
.stories-rail--desktop::-webkit-scrollbar { display: none; }
@media (min-width: 768px) {
  .stories-rail--desktop {
    gap: 12px;
    padding: 0 40px 24px;
  }
}
@media (min-width: 1200px) {
  .stories-rail--desktop {
    gap: 14px;
    padding: 0 48px 28px;
  }
}

.story-card {
  flex: 0 0 auto;
  position: relative;
  width: 270px;
  height: 406px;
  border-radius: 12px;
  overflow: hidden;
  cursor: pointer;
  scroll-snap-align: start;
  -webkit-user-select: none; user-select: none;
  background: #f0f0f0;
  transition: transform 0.22s ease, box-shadow 0.22s ease;
}
@media (min-width: 480px) {
  .story-card { width: 314px; height: 470px; }
}
@media (min-width: 768px) {
  .story-card { width: 265px; height: 397px; }
}
@media (min-width: 1024px) {
  .story-card { width: 291px; height: 437px; }
}
@media (min-width: 1200px) {
  .story-card { width: 317px; height: 476px; }
}
@media (min-width: 1440px) {
  .story-card { width: 345px; height: 518px; }
}

.story-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 32px rgba(0,0,0,0.12);
}
.story-card:active { transform: scale(0.98); }

.story-card__img {
  position: absolute; inset: 0;
}
.story-card__img img {
  width: 100%; height: 100%;
  object-fit: cover; display: block;
  transition: transform 0.4s ease;
}
.story-card:hover .story-card__img img {
  transform: scale(1.04);
}

.story-card__overlay {
  position: absolute; inset: 0;
  background: linear-gradient(
    to top,
    rgba(0,0,0,0.7) 0%,
    rgba(0,0,0,0.25) 35%,
    transparent 60%
  );
  pointer-events: none; z-index: 1;
}

/* accent bar removed */

.story-card__dots {
  position: absolute;
  top: 14px; left: 14px;
  display: flex; gap: 4px;
  z-index: 3;
}
.story-card__dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: rgba(255,255,255,0.5);
}
.story-card__dot:first-child { background: rgba(255,255,255,0.95); }

.story-card__content {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  padding: 16px;
  z-index: 2;
}
.story-card__subtitle {
  font-size: 10px; font-weight: 500;
  letter-spacing: 0.1em; text-transform: uppercase;
  color: rgba(255,255,255,0.7);
  margin-bottom: 4px;
}
.story-card__title {
  font-size: 15px; font-weight: 600;
  color: #fff; line-height: 1.25;
  text-shadow: 0 1px 4px rgba(0,0,0,0.3);
}
@media (min-width: 1200px) {
  .story-card__title { font-size: 16px; }
}

/* Desktop scroll arrows */
.stories-rail-wrap {
  position: relative;
}

.stories-nav {
  display: flex;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 4;
}
.stories-nav--left { left: 8px; }
.stories-nav--right { right: 8px; }
@media (min-width: 1200px) {
  .stories-nav--left { left: 12px; }
  .stories-nav--right { right: 12px; }
}

.stories-nav-btn {
  width: 40px; height: 40px;
  border-radius: 50%; border: none;
  background: rgba(255,255,255,0.92);
  box-shadow: 0 2px 10px rgba(0,0,0,0.12);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  color: #111;
  transition: background 0.15s, transform 0.15s, opacity 0.2s;
  opacity: 0; pointer-events: none;
}
.stories-nav-btn.visible {
  opacity: 1; pointer-events: auto;
}
.stories-nav-btn:hover {
  background: #fff; transform: scale(1.08);
}

/* ============================================================
   FULLSCREEN STORY VIEWER
   ============================================================ */
.story-viewer-overlay {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  position: fixed; inset: 0;
  z-index: 999999;
  background: rgba(0,0,0,0.92);
  display: flex; align-items: center; justify-content: center;
  opacity: 0; visibility: hidden;
  transition: opacity 0.28s ease, visibility 0.28s ease;
}
.story-viewer-overlay.active { opacity: 1; visibility: visible; }

.story-viewer {
  position: relative;
  width: 100%; height: 100%;
  max-width: 440px; max-height: 100%;
  overflow: hidden; background: #111;
}
@media (min-width: 600px) {
  .story-viewer {
    max-height: 92vh;
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  }
}

.story-viewer__media {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  background: #111;
}
.story-viewer__media img {
  width: 100%; height: 100%;
  object-fit: cover; display: block;
}

.story-viewer__grad-top {
  position: absolute; top: 0; left: 0; right: 0; height: 160px;
  background: linear-gradient(to bottom, rgba(0,0,0,0.55) 0%, transparent 100%);
  pointer-events: none; z-index: 2;
}
.story-viewer__grad-bottom {
  position: absolute; bottom: 0; left: 0; right: 0; height: 220px;
  background: linear-gradient(to top, rgba(0,0,0,0.65) 0%, transparent 100%);
  pointer-events: none; z-index: 2;
}

.story-viewer__progress {
  position: absolute; top: 0; left: 0; right: 0;
  display: flex; gap: 4px;
  padding: 12px 12px 0;
  padding-top: calc(12px + env(safe-area-inset-top, 0px));
  z-index: 10;
}
.story-viewer__bar {
  flex: 1; height: 2.5px;
  background: rgba(255,255,255,0.3);
  border-radius: 2px; overflow: hidden;
}
.story-viewer__bar-fill {
  height: 100%; width: 0%;
  background: #fff; border-radius: 2px;
  transition: none;
}
.story-viewer__bar.completed .story-viewer__bar-fill { width: 100%; }
.story-viewer__bar.active .story-viewer__bar-fill { transition: width linear; }

.story-viewer__header {
  position: absolute; top: 0; left: 0; right: 0;
  display: flex; align-items: center; gap: 10px;
  padding: 28px 14px 0;
  padding-top: calc(28px + env(safe-area-inset-top, 0px));
  z-index: 10;
}
.story-viewer__avatar {
  width: 34px; height: 34px;
  border-radius: 50%; border: 2px solid #fff;
  overflow: hidden; flex-shrink: 0;
}
.story-viewer__avatar img { width: 100%; height: 100%; object-fit: cover; }
.story-viewer__info { flex: 1; min-width: 0; }
.story-viewer__title {
  font-size: 13px; font-weight: 600; color: #fff;
  line-height: 1.2; text-shadow: 0 1px 3px rgba(0,0,0,0.4);
}
.story-viewer__time {
  font-size: 11px; color: rgba(255,255,255,0.7); line-height: 1.2;
}

.story-viewer__close {
  position: absolute;
  top: 28px; top: calc(28px + env(safe-area-inset-top, 0px));
  right: 14px; z-index: 12;
  width: 32px; height: 32px;
  display: flex; align-items: center; justify-content: center;
  background: rgba(0,0,0,0.3);
  backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
  border: none; border-radius: 50%;
  cursor: pointer; color: #fff;
  font-size: 18px; line-height: 1;
  transition: background 0.15s;
}
.story-viewer__close:hover { background: rgba(0,0,0,0.5); }

.story-viewer__tap-left,
.story-viewer__tap-right {
  position: absolute; top: 0; bottom: 0; z-index: 5; cursor: pointer;
}
.story-viewer__tap-left { left: 0; width: 35%; }
.story-viewer__tap-right { right: 0; width: 65%; }

.story-viewer__cta {
  position: absolute; bottom: 0; left: 0; right: 0;
  padding: 20px 16px;
  padding-bottom: calc(20px + env(safe-area-inset-bottom, 0px));
  z-index: 10;
  display: flex; flex-direction: column; gap: 6px;
}
.story-viewer__cta-label {
  font-size: 11px; font-weight: 500;
  letter-spacing: 0.06em; text-transform: uppercase;
  color: rgba(255,255,255,0.7);
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}
.story-viewer__cta-product {
  font-size: 15px; font-weight: 600; color: #fff;
  line-height: 1.3; text-shadow: 0 1px 4px rgba(0,0,0,0.5);
}
.story-viewer__cta-price {
  font-size: 14px; font-weight: 400;
  color: rgba(255,255,255,0.85);
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}
.story-viewer__cta-btn {
  display: inline-flex; align-items: center; justify-content: center;
  gap: 6px; margin-top: 8px;
  padding: 11px 24px;
  background: #fff; color: #111;
  font-family: inherit; font-size: 13px; font-weight: 600;
  letter-spacing: 0.04em; text-transform: uppercase;
  border: none; border-radius: 0; cursor: pointer;
  transition: background 0.15s, transform 0.12s;
  align-self: flex-start;
}
.story-viewer__cta-btn:active { transform: scale(0.97); }
.story-viewer__cta-btn svg { width: 14px; height: 14px; }

.story-viewer__nav-arrow {
  display: none;
  position: absolute;
  top: 50%; transform: translateY(-50%);
  z-index: 15;
  width: 44px; height: 44px;
  border-radius: 50%; border: none;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
  color: #fff; cursor: pointer;
  align-items: center; justify-content: center;
  font-size: 20px; transition: background 0.15s;
}
.story-viewer__nav-arrow:hover { background: rgba(255,255,255,0.25); }
.story-viewer__nav-prev { left: -56px; }
.story-viewer__nav-next { right: -56px; }
@media (min-width: 600px) {
  .story-viewer__nav-arrow { display: flex; }
}

.story-viewer__spinner {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  z-index: 1;
}
.story-viewer__spinner::after {
  content: '';
  width: 32px; height: 32px;
  border: 2.5px solid rgba(255,255,255,0.2);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* ============================================================
   DEMO PAGE WRAPPER (remove in production)
   ============================================================ */
.demo-page {
  max-width: 100%; min-height: 100vh; background: #fff;
}
.demo-placeholder {
  padding: 40px 20px;
  text-align: center; color: #bbb;
  font-family: 'Inter', sans-serif; font-size: 14px;
  border-top: 1px solid #f0f0f0;
}
</style>
</head>
<body>

<div class="demo-page">

  <!-- ========================================================
       ★ STORIES COMPONENT — start copy ★
       ======================================================== -->
  <div class="stories-root" id="storiesRoot">
    <div class="stories-header">
      <h2>The Look Of The Games</h2>
    </div>

    <!-- Cards rail with scroll arrows -->
    <div class="stories-rail-wrap">
      <div class="stories-nav stories-nav--left">
        <button class="stories-nav-btn" id="railPrev" aria-label="Scroll left">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
        </button>
      </div>
      <div class="stories-rail--desktop" id="storiesRailDesktop"></div>
      <div class="stories-nav stories-nav--right">
        <button class="stories-nav-btn" id="railNext" aria-label="Scroll right">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
        </button>
      </div>
    </div>
  </div>
  <!-- ★ STORIES COMPONENT — end copy ★ -->

  <div class="demo-placeholder"><p>— Page content continues below —</p></div>
</div>

<!-- Fullscreen viewer -->
<div class="story-viewer-overlay" id="storyOverlay">
  <div class="story-viewer" id="storyViewer">
    <div class="story-viewer__spinner" id="storySpinner"></div>
    <div class="story-viewer__media" id="storyMedia">
      <img id="storyImage" src="" alt="">
      <video id="storyVideo" playsinline muted preload="auto" style="width:100%;height:100%;object-fit:cover;display:none;"></video>
    </div>
    <div class="story-viewer__grad-top"></div>
    <div class="story-viewer__grad-bottom"></div>
    <div class="story-viewer__progress" id="storyProgress"></div>
    <div class="story-viewer__header">
      <div class="story-viewer__avatar" id="storyAvatar"><img src="" alt=""></div>
      <div class="story-viewer__info">
        <div class="story-viewer__title" id="storyOwner"></div>
        <div class="story-viewer__time" id="storyTimestamp"></div>
      </div>
    </div>
    <button class="story-viewer__close" id="storyClose" aria-label="Close">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
    <div class="story-viewer__tap-left" id="tapLeft"></div>
    <div class="story-viewer__tap-right" id="tapRight"></div>
    <div class="story-viewer__cta" id="storyCta"></div>
    <button class="story-viewer__nav-arrow story-viewer__nav-prev" id="navPrev" aria-label="Previous story">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
    </button>
    <button class="story-viewer__nav-arrow story-viewer__nav-next" id="navNext" aria-label="Next story">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
    </button>
  </div>
</div>

<script>
/* ============================================================
   STORIES DATA
   ============================================================ */
const STORIES = [
  {
    id: 'olympic-jacket',
    title: 'That Viral Olympic Jacket',
    subtitle: 'Lookbook',
    avatar: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/assets/stories/generated-image-caimera-cmlph3ij701uo3oqn5ma97o05.jpeg',
    thumb: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/assets/stories/generated-image-caimera-cmlph3ij701uo3oqn5ma97o05.jpeg',
    slides: [
      {
        label: 'Classic Lines',
        product: 'Olympic Sateen Bomber',
        cta: 'Shop Now',
        duration: 5000,
        price: '£130',
        link: 'https://shop.olympics.com/en/olympic-games/the-olympic-collection-sateen-jacket-off-white/t-10369398+p-577779829801314+z-9-1573407505',
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/assets/stories/generated-image-caimera-cmlph3ij701uo3oqn5ma97o05.jpeg'
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/generated-image-caimera-cmlnsert50aao3onu6cznarut%20(1).jpeg',
        label: 'Colder Than Ice',
        cta: 'Shop Now',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/edited-image-caimera-cmlns0ikw0aad3onug3gn9qfv%20(1).jpeg',
        label: 'The Jacket',
        product: 'Olympic Heritage Jacket',
        cta: 'Shop Now',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/generated-image-caimera-cmlmrpo7p09db3onub140fd05.png',
        label: 'The Look',
        product: 'Style it your way',
        cta: 'Shop Now',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/edited-image-caimera-cmlmromav09da3onuabcb120o.jpeg',
        label: 'Get Yours',
        product: 'Limited availability',
        cta: 'Shop Now',
        duration: 5000
      }
    ]
  },
  {
    id: 'heritage-collection',
    title: 'Heritage Collection',
    subtitle: 'LA 1984 & more',
    avatar: 'https://shop.olympics.com/content/ws/all/33cf35cd-1125-4383-a9b9-8b45b8b5d77a__800X1080.png?w=800',
    thumb: 'https://shop.olympics.com/content/ws/all/33cf35cd-1125-4383-a9b9-8b45b8b5d77a__800X1080.png?w=800',
    slides: [
      {
        image: 'https://shop.olympics.com/content/ws/all/33cf35cd-1125-4383-a9b9-8b45b8b5d77a__800X1080.png?w=800',
        label: 'Heritage Collection',
        product: 'Iconic Games moments',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/the-heritage-collection/x-3078',
        duration: 5000
      },
      {
        image: 'https://shop.olympics.com/content/ws/all/e19747a7-8193-42ee-b002-b688299c529b__800X1080.png?w=800',
        label: 'Heritage Collection',
        product: 'Celebrate Olympic history',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/the-heritage-collection/x-3078',
        duration: 5000
      },
      {
        image: 'https://shop.olympics.com/content/ws/all/b324ec2a-b5aa-4e58-943a-bde6efb49015__800X1080.png?w=800',
        label: 'Heritage Collection',
        product: 'Timeless Olympic design',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/the-heritage-collection/x-3078',
        duration: 5000
      },
      {
        image: 'https://shop.olympics.com/content/ws/all/49269a39-11cd-41a5-8c28-2272ffa3b538__800X1080.png?w=800',
        label: 'Heritage Collection',
        product: 'Vintage inspired',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/the-heritage-collection/x-3078',
        duration: 5000
      },
      {
        image: 'https://shop.olympics.com/content/ws/all/6ba7ad74-1fe1-488c-bdf1-78519720ec1a__800X1080.png?w=800',
        label: 'Heritage Collection',
        product: 'Classic Olympic style',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/the-heritage-collection/x-3078',
        duration: 5000
      },
      {
        image: 'https://shop.olympics.com/content/ws/all/be5074bb-70e4-47dc-b40b-6a4df0647006__800X1080.png?w=800',
        label: 'Heritage Collection',
        product: 'From the archives',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/the-heritage-collection/x-3078',
        duration: 5000
      },
      {
        image: 'https://shop.olympics.com/content/ws/all/a10ac309-256c-49ce-8fb9-119d29977ef3__800X1080.png?w=800',
        label: 'Heritage Collection',
        product: 'Shop the collection',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/the-heritage-collection/x-3078',
        duration: 5000
      }
    ]
  },
  {
    id: 'mascot-fever',
    title: 'Mascot Fever',
    subtitle: 'Meet Tina and Milo!',
    avatar: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/2c9c1831-e31b-43bb-aa4a-c79d09ac12af__800X1080.avif',
    thumb: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/2c9c1831-e31b-43bb-aa4a-c79d09ac12af__800X1080.avif',
    slides: [
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/2c9c1831-e31b-43bb-aa4a-c79d09ac12af__800X1080.avif',
        label: 'Milano Cortina 2026',
        product: 'Meet the Mascots',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-paralympics-milo-mascot-18cm/t-68583427+p-68225845360355+z-8-1862398107',
        duration: 5000
      },
      {
        type: 'video',
        src: 'https://github.com/cdbxyz/shopthelook/blob/27c5273bf11a331fd5c8f8bbf2ac4f745b521a9c/Product_Video_Generation.mp4?raw=true',
        label: 'Milano Cortina 2026',
        product: 'Meet the Mascots',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-paralympics-milo-mascot-18cm/t-68583427+p-68225845360355+z-8-1862398107',
        duration: 10000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/27c5273bf11a331fd5c8f8bbf2ac4f745b521a9c/Generated%20Image%20February%2015%2C%202026%20-%203_49PM.jpeg',
        label: 'Gift idea',
        product: 'The perfect Games souvenir',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-paralympics-milo-mascot-18cm/t-68583427+p-68225845360355+z-8-1862398107',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/27c5273bf11a331fd5c8f8bbf2ac4f745b521a9c/milano-cortina-2026-paralympics-milo-mascot-18cm_ss5_p-203134823%2Bpv-2%2Bu-fn8yfsumh7oj18ceatp5%2Bv-vgrtc6f9ipdzeajhsrlz.avif',
        label: 'Hurry - limited edition!',
        product: 'Milo Mascot — Official Product',
        price: '£22.00',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-paralympics-milo-mascot-18cm/t-68583427+p-68225845360355+z-8-1862398107',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/27c5273bf11a331fd5c8f8bbf2ac4f745b521a9c/Generated%20Image%20February%2015%2C%202026%20-%203_47PM.jpeg',
        label: 'Mascot Fever',
        product: 'Milo Paralympic Mascot — 18cm',
        price: '£22.00',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-paralympics-milo-mascot-18cm/t-68583427+p-68225845360355+z-8-1862398107',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/27c5273bf11a331fd5c8f8bbf2ac4f745b521a9c/milano-cortina-2026-olympics-tina-mascot-13cm_ss5_p-203134819%2Bpv-2%2Bu-3oa9jwefkp6b65ljah1u%2Bv-xwf6xrdduv1gobuo0ggi.avif',
        label: 'Collect them all',
        product: 'Tina Olympic Mascot — 13cm',
        price: '£18.00',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-paralympics-milo-mascot-18cm/t-68583427+p-68225845360355+z-8-1862398107',
        duration: 5000
      }
    ]
  },
  {
    id: 'olympic-collection',
    title: 'The Olympic Collection',
    subtitle: 'Shop the range',
    avatar: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/stories/assets/Gemini_Generated_Image_3kq61n3kq61n3kq6%20(1)%20(1).png',
    thumb: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/stories/assets/Gemini_Generated_Image_3kq61n3kq61n3kq6%20(1)%20(1).png',
    slides: [
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/stories/assets/Gemini_Generated_Image_3kq61n3kq61n3kq6%20(1)%20(1).png',
        label: 'The Olympic Collection',
        product: 'Studio Fleece Hoodie — Marshmallow',
        price: '£85.00',
        cta: 'Shop Now',
        duration: 5000
      },
      {
        type: 'video',
        src: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/Jacket_Product_Video_Generation%20(1).mp4',
        label: 'The Olympic Collection',
        product: 'Full Zip Hoodie — White',
        cta: 'Shop Now',
        duration: 10000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/the-olympic-collection-full-zip-hoodie-white_ss5_p-202491288%2Bpv-1%2Bu-g5nsdliunyg0le9mocqk%2Bv-61i1zrr7oootpzrjksng.avif',
        label: 'The Olympic Collection',
        product: 'Full Zip Hoodie — White',
        price: '£95.00',
        cta: 'Shop Now',
        duration: 5000
      },
      {
        type: 'video',
        src: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/Product_Video_Generation_Request%20(1).mp4',
        label: 'The Olympic Collection',
        product: 'Microfleece Jacket — White',
        cta: 'Shop Now',
        duration: 10000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/the-olympic-collection-microfleece-jacket-white_ss5_p-202491289%2Bpv-1%2Bu-lgvzdnrjovfexsdjnaox%2Bv-ozkn1mjs5i7ctpjhdt59.avif',
        label: 'The Olympic Collection',
        product: 'Microfleece Jacket — White',
        price: '£110.00',
        cta: 'Shop Now',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/the-olympic-collection-puffer-jacket-black_ss5_p-202851949%2Bpv-1%2Bu-zmgtnz5tlxmchevz8y88%2Bv-0qz034iqeatnuvb2xreb.avif',
        label: 'The Olympic Collection',
        product: 'Puffer Jacket — Black',
        price: '£165.00',
        cta: 'Shop Now',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/refs/heads/main/the-olympic-collection-tech-midlayer-white_ss5_p-202491284%2Bpv-1%2Bu-upsuj2iulgkxmcdhdp3o%2Bv-dmbycwu7jqe0maigzg5m.avif',
        label: 'The Olympic Collection',
        product: 'Tech Midlayer — White',
        price: '£120.00',
        cta: 'Shop Now',
        duration: 5000
      }
    ]
  },
  {
    id: 'salomon',
    title: 'Salomon x Milano',
    subtitle: 'Milano Cortina 2026',
    avatar: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/stories/assets/Generated%20Image%20February%2015%2C%202026%20-%2010_00PM.jpg',
    thumb: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/stories/assets/Generated%20Image%20February%2015%2C%202026%20-%2010_00PM.jpg',
    slides: [
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/stories/assets/Generated%20Image%20February%2015%2C%202026%20-%2010_00PM.jpg',
        label: 'Salomon x Olympics',
        product: 'Outline Warm Jacket — Blue',
        price: '$350.00',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-olympics-salomon-outline-warm-jacket-blue/t-35588905+p-799914777138581+z-9-836252093',
        duration: 5000
      },
      {
        image: '//images.footballfanatics.com/milano-cortina-2026/milano-cortina-2026-olympics-salomon-outline-warm-jacket-blue_ss5_p-203045233+pv-2+u-2xvbhyaelrlvbkhg5o4u+v-5duo1esaw7yeovyeojj8.jpg?_hv=2&w=1018',
        label: 'Salomon x Olympics',
        product: 'Outline Warm Jacket — Back Detail',
        price: '$350.00',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-olympics-salomon-outline-warm-jacket-blue/t-35588905+p-799914777138581+z-9-836252093',
        duration: 5000
      },
      {
        image: '//images.footballfanatics.com/milano-cortina-2026/milano-cortina-2026-olympics-salomon-outline-warm-jacket-blue_ss5_p-203045233+pv-5+u-2xvbhyaelrlvbkhg5o4u+v-x0zp8exct5shlgsrdugh.jpeg?_hv=2&w=1018',
        label: 'On the slopes',
        product: 'Built for the mountain — worn in the city',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-olympics-salomon-outline-warm-jacket-blue/t-35588905+p-799914777138581+z-9-836252093',
        duration: 5000
      },
      {
        image: '//images.footballfanatics.com/milano-cortina-2026/milano-cortina-2026-olympics-salomon-outline-warm-jacket-blue_ss5_p-203045233+pv-6+u-2xvbhyaelrlvbkhg5o4u+v-w2kvdmhvzjyfoozho4n8.jpeg?_hv=2&w=1018',
        label: 'Winter ready',
        product: 'Premium insulation for Milano Cortina',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/milano-cortina-2026/milano-cortina-2026-olympics-salomon-outline-warm-jacket-blue/t-35588905+p-799914777138581+z-9-836252093',
        duration: 5000
      }
    ]
  },
  {
    id: 'hockey-jerseys',
    title: 'On Ice Looks',
    subtitle: '2026 Replicas',
    avatar: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/33fc466d91178b230dde2fbdedb9ed260b8ce871/Screenshot%202026-02-15%20at%2020.22.55.png',
    thumb: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/33fc466d91178b230dde2fbdedb9ed260b8ce871/Screenshot%202026-02-15%20at%2020.22.55.png',
    slides: [
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/33fc466d91178b230dde2fbdedb9ed260b8ce871/Screenshot%202026-02-15%20at%2020.22.55.png',
        label: 'On Ice Looks',
        product: 'Olympic Hockey Jerseys 2026',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/hockey-canada/youth-connor-mcdavid-red-hockey-canada-2026-replica-jersey/t-21132190+p-243314274296997+z-9-973068861',
        duration: 5000
      },
      {
        image: 'https://raw.githubusercontent.com/cdbxyz/shopthelook/main/stories/assets/200444441f.jpeg',
        label: 'Casual Looks',
        product: 'Woven Track Jacket',
        price: '£99',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/olympic-games/the-olympic-collection-woven-track-jacket/t-43363754+p-24110093718776+z-8-3519754992',
        duration: 5000
      },
      {
        image: '//images.footballfanatics.com/hockey-canada/youth-connor-mcdavid-red-hockey-canada-2026-replica-jersey_ss5_p-203587785+pv-1+u-2dohrbgb1tjug93kslp0+v-vqgeyb9s3npbtatsyxyi.jpg?_hv=2&w=1018',
        label: 'Hockey Canada',
        product: 'Youth McDavid 2026 Replica Jersey',
        price: '$236.00',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/hockey-canada/youth-connor-mcdavid-red-hockey-canada-2026-replica-jersey/t-21132190+p-243314274296997+z-9-973068861',
        duration: 5000
      },
      {
        image: '//images.footballfanatics.com/hockey-canada/youth-connor-mcdavid-red-hockey-canada-2026-replica-jersey_ss5_p-203587785+pv-2+u-2dohrbgb1tjug93kslp0+v-ugeddidxiixp2jffzrjh.jpg?_hv=2&w=1018',
        label: 'Hockey Canada',
        product: 'Back Detail — #97 McDavid',
        price: '$236.00',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/hockey-canada/youth-connor-mcdavid-red-hockey-canada-2026-replica-jersey/t-21132190+p-243314274296997+z-9-973068861',
        duration: 5000
      },
      {
        image: '//images.footballfanatics.com/hockey-canada/youth-connor-mcdavid-red-hockey-canada-2026-replica-jersey_ss5_p-203587785+pv-3+u-2dohrbgb1tjug93kslp0+v-2f2kmbtraccrapz8avs3.jpg?_hv=2&w=1018',
        label: 'Game ready',
        product: 'Breathable mesh & ventilation panels',
        cta: 'Shop Now',
        link: 'https://shop.olympics.com/en/hockey-canada/youth-connor-mcdavid-red-hockey-canada-2026-replica-jersey/t-21132190+p-243314274296997+z-9-973068861',
        duration: 5000
      }
    ]
  }
];

/* ============================================================
   DOM REFS
   ============================================================ */
const railDesktop = document.getElementById('storiesRailDesktop');
const overlay = document.getElementById('storyOverlay');
const viewer = document.getElementById('storyViewer');
const storyImage = document.getElementById('storyImage');
const storyVideo = document.getElementById('storyVideo');
const storyProgress = document.getElementById('storyProgress');
const storyAvatarImg = document.querySelector('#storyAvatar img');
const storyOwner = document.getElementById('storyOwner');
const storyTimestamp = document.getElementById('storyTimestamp');
const storyCta = document.getElementById('storyCta');
const storySpinner = document.getElementById('storySpinner');
const tapLeft = document.getElementById('tapLeft');
const tapRight = document.getElementById('tapRight');
const closeBtn = document.getElementById('storyClose');
const navPrev = document.getElementById('navPrev');
const navNext = document.getElementById('navNext');
const railPrevBtn = document.getElementById('railPrev');
const railNextBtn = document.getElementById('railNext');

let currentStoryIdx = 0;
let currentSlideIdx = 0;
let timer = null;
let isPaused = false;
let timerStart = 0;
let timerRemaining = 0;
let longPressTimer = null;
let swipeStartX = 0;

/* ============================================================
   RENDER BOTH RAILS
   ============================================================ */
STORIES.forEach((story, idx) => {
  const card = document.createElement('div');
  card.className = 'story-card';
  card.dataset.index = idx;
  const dotsHTML = story.slides.map(() => `<div class="story-card__dot"></div>`).join('');
  card.innerHTML = `
    <div class="story-card__dots">${dotsHTML}</div>
    <div class="story-card__img">
      <img src="${story.thumb}" alt="${story.title}" loading="${idx < 5 ? 'eager' : 'lazy'}">
    </div>
    <div class="story-card__overlay"></div>
    <div class="story-card__content">
      <div class="story-card__subtitle">${story.subtitle}</div>
      <div class="story-card__title">${story.title}</div>
    </div>
  `;
  card.addEventListener('click', () => openStory(idx));
  railDesktop.appendChild(card);
});

/* ============================================================
   DESKTOP RAIL SCROLL ARROWS
   ============================================================ */
function updateRailArrows() {
  const sl = railDesktop.scrollLeft;
  const maxScroll = railDesktop.scrollWidth - railDesktop.clientWidth;
  railPrevBtn.classList.toggle('visible', sl > 10);
  railNextBtn.classList.toggle('visible', sl < maxScroll - 10);
}
railDesktop.addEventListener('scroll', updateRailArrows, { passive: true });
window.addEventListener('resize', updateRailArrows);
setTimeout(updateRailArrows, 200);

railPrevBtn.addEventListener('click', () => {
  railDesktop.scrollBy({ left: -railDesktop.clientWidth * 0.75, behavior: 'smooth' });
});
railNextBtn.addEventListener('click', () => {
  railDesktop.scrollBy({ left: railDesktop.clientWidth * 0.75, behavior: 'smooth' });
});

/* ============================================================
   VIEWER LOGIC
   ============================================================ */
function openStory(storyIdx, slideIdx = 0) {
  currentStoryIdx = storyIdx;
  currentSlideIdx = slideIdx;
  document.body.style.overflow = 'hidden';
  overlay.classList.add('active');
  renderSlide();
}

function closeStory() {
  overlay.classList.remove('active');
  document.body.style.overflow = '';
  clearTimeout(timer);
  storyVideo.pause();
  markViewed(currentStoryIdx);
}

function markViewed(idx) {
  const card = railDesktop.querySelector(`[data-index="${idx}"]`);
  if (card) card.classList.add('viewed');
}

function renderSlide() {
  const story = STORIES[currentStoryIdx];
  const slide = story.slides[currentSlideIdx];

  storyAvatarImg.src = story.avatar;
  storyOwner.textContent = story.title;
  storyTimestamp.textContent = story.subtitle;

  storyProgress.innerHTML = story.slides.map((_, i) => {
    let cls = i < currentSlideIdx ? 'completed' : i === currentSlideIdx ? 'active' : '';
    return `<div class="story-viewer__bar ${cls}"><div class="story-viewer__bar-fill"></div></div>`;
  }).join('');

  storySpinner.style.display = 'flex';

  // Reset media
  storyImage.style.display = 'none';
  storyVideo.style.display = 'none';
  storyVideo.pause();
  storyVideo.removeAttribute('src');

  if (slide.type === 'video') {
    storyVideo.src = slide.src;
    storyVideo.style.display = 'block';
    storyVideo.load();
    const onReady = () => {
      storySpinner.style.display = 'none';
      storyVideo.play().catch(() => {});
      const dur = slide.duration || (storyVideo.duration * 1000) || 10000;
      startTimer(dur);
    };
    if (storyVideo.readyState >= 3) { onReady(); }
    else { storyVideo.oncanplay = onReady; }
  } else {
    storyImage.style.display = 'block';
    const img = new Image();
    img.onload = () => {
      storyImage.src = img.src;
      storySpinner.style.display = 'none';
      startTimer(slide.duration || 5000);
    };
    img.onerror = () => {
      storySpinner.style.display = 'none';
      startTimer(slide.duration || 5000);
    };
    img.src = slide.image;
    if (img.complete) {
      storyImage.src = img.src;
      storySpinner.style.display = 'none';
    }
  }

  let h = '';
  if (slide.label)   h += `<div class="story-viewer__cta-label">${slide.label}</div>`;
  if (slide.product) h += `<div class="story-viewer__cta-product">${slide.product}</div>`;
  if (slide.price)   h += `<div class="story-viewer__cta-price">${slide.price}</div>`;
  if (slide.cta) {
    const href = slide.link ? ` onclick="window.open('${slide.link}','_blank')"` : '';
    h += `<button class="story-viewer__cta-btn"${href}>${slide.cta}<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></button>`;
  }
  storyCta.innerHTML = h;

  preloadNext();
}

function startTimer(duration) {
  clearTimeout(timer);
  timerRemaining = duration;
  timerStart = Date.now();
  const fill = storyProgress.querySelector('.story-viewer__bar.active .story-viewer__bar-fill');
  if (fill) {
    fill.style.transition = 'none';
    fill.style.width = '0%';
    fill.offsetWidth;
    fill.style.transition = `width ${duration}ms linear`;
    fill.style.width = '100%';
  }
  timer = setTimeout(goNext, duration);
}

function pauseTimer() {
  if (isPaused) return;
  isPaused = true;
  clearTimeout(timer);
  timerRemaining -= (Date.now() - timerStart);
  storyVideo.pause();
  const fill = storyProgress.querySelector('.story-viewer__bar.active .story-viewer__bar-fill');
  if (fill) {
    const w = getComputedStyle(fill).width;
    fill.style.transition = 'none';
    fill.style.width = w;
  }
}

function resumeTimer() {
  if (!isPaused) return;
  isPaused = false;
  if (storyVideo.style.display !== 'none') storyVideo.play().catch(() => {});
  const fill = storyProgress.querySelector('.story-viewer__bar.active .story-viewer__bar-fill');
  if (fill) {
    fill.offsetWidth;
    fill.style.transition = `width ${timerRemaining}ms linear`;
    fill.style.width = '100%';
  }
  timerStart = Date.now();
  timer = setTimeout(goNext, timerRemaining);
}

function goNext() {
  clearTimeout(timer);
  storyVideo.pause();
  const story = STORIES[currentStoryIdx];
  if (currentSlideIdx < story.slides.length - 1) {
    currentSlideIdx++;
    renderSlide();
  } else if (currentStoryIdx < STORIES.length - 1) {
    markViewed(currentStoryIdx);
    currentStoryIdx++;
    currentSlideIdx = 0;
    renderSlide();
  } else {
    closeStory();
  }
}

function goPrev() {
  clearTimeout(timer);
  storyVideo.pause();
  if (currentSlideIdx > 0) {
    currentSlideIdx--;
    renderSlide();
  } else if (currentStoryIdx > 0) {
    currentStoryIdx--;
    currentSlideIdx = STORIES[currentStoryIdx].slides.length - 1;
    renderSlide();
  } else {
    currentSlideIdx = 0;
    renderSlide();
  }
}

function preloadNext() {
  const story = STORIES[currentStoryIdx];
  let next = null;
  if (currentSlideIdx < story.slides.length - 1)
    next = story.slides[currentSlideIdx + 1];
  else if (currentStoryIdx < STORIES.length - 1)
    next = STORIES[currentStoryIdx + 1].slides[0];
  if (next && !next.type) { const img = new Image(); img.src = next.image; }
}

/* ============================================================
   EVENTS
   ============================================================ */
closeBtn.addEventListener('click', e => { e.stopPropagation(); closeStory(); });
navNext.addEventListener('click', e => { e.stopPropagation(); goNext(); });
navPrev.addEventListener('click', e => { e.stopPropagation(); goPrev(); });
tapRight.addEventListener('click', goNext);
tapLeft.addEventListener('click', goPrev);

viewer.addEventListener('touchstart', () => {
  longPressTimer = setTimeout(pauseTimer, 200);
}, { passive: true });
viewer.addEventListener('touchend', () => {
  clearTimeout(longPressTimer);
  if (isPaused) resumeTimer();
}, { passive: true });
viewer.addEventListener('touchmove', () => {
  clearTimeout(longPressTimer);
}, { passive: true });

overlay.addEventListener('touchstart', e => { swipeStartX = e.touches[0].clientX; }, { passive: true });
overlay.addEventListener('touchend', e => {
  const dx = e.changedTouches[0].clientX - swipeStartX;
  if (Math.abs(dx) > 60) { dx < 0 ? goNext() : goPrev(); }
}, { passive: true });

viewer.addEventListener('mousedown', e => {
  if (e.target.closest('.story-viewer__close, .story-viewer__cta-btn, .story-viewer__nav-arrow')) return;
  longPressTimer = setTimeout(pauseTimer, 200);
});
viewer.addEventListener('mouseup', () => {
  clearTimeout(longPressTimer);
  if (isPaused) resumeTimer();
});

document.addEventListener('keydown', e => {
  if (!overlay.classList.contains('active')) return;
  if (e.key === 'ArrowRight') goNext();
  else if (e.key === 'ArrowLeft') goPrev();
  else if (e.key === 'Escape') closeStory();
});

overlay.addEventListener('click', e => { if (e.target === overlay) closeStory(); });
</script>
</body>
</html>
